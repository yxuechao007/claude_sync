# claude_sync

Claude Code é…ç½®åŒæ­¥å·¥å…·ï¼ŒåŸºäº GitHub Gist åœ¨å¤šè®¾å¤‡é—´åŒæ­¥é…ç½®æ–‡ä»¶å’Œç›®å½•ã€‚

## åŠŸèƒ½

- GitHub OAuth Device Flow è®¤è¯ï¼ˆç»ˆç«¯æ˜¾ç¤ºçŸ­ç ï¼Œç½‘é¡µè¾“å…¥æˆæƒï¼‰
- push/pull/status å¸¸ç”¨åŒæ­¥å‘½ä»¤
- **Diff ç¡®è®¤**ï¼šä¿®æ”¹æœ¬åœ°æ–‡ä»¶å‰æ˜¾ç¤ºå·®å¼‚å¹¶ç­‰å¾…ç¡®è®¤
- ç›®å½•æ‰“åŒ…åŒæ­¥ï¼ˆè‡ªåŠ¨è·³è¿‡éšè—æ–‡ä»¶ï¼‰
- JSON å­—æ®µè¿‡æ»¤ï¼ˆå¦‚æ’é™¤æœ¬åœ°ç¯å¢ƒå˜é‡ï¼‰
- **Hooks æ™ºèƒ½è¿‡æ»¤**ï¼šPush æ—¶è‡ªåŠ¨è¿‡æ»¤åŒ…å«æœ¬åœ°è·¯å¾„çš„ hooks
- hooks é£é™©æ£€æµ‹ä¸åˆå¹¶ç­–ç•¥ï¼ˆè¦†ç›–/ä¿ç•™/æ™ºèƒ½åˆå¹¶ï¼‰
- **MCP é¡¹ç›®åŒæ­¥**ï¼šå°†å…¨å±€ MCP é…ç½®åŒæ­¥åˆ°å½“å‰é¡¹ç›®
- dry-run é¢„è§ˆä¸å†²çªæç¤º

## å®‰è£…

### ä¸€é”®å®‰è£…ï¼ˆæ¨èï¼‰

```bash
curl -sSL https://raw.githubusercontent.com/yxuechao007/claude_sync/main/install.sh | sh
```

è„šæœ¬ä¼šä¸‹è½½ GitHub Release çš„æœ€æ–°äºŒè¿›åˆ¶å¹¶å®‰è£…åˆ° `/usr/local/bin`ã€‚

### ä»æºç å®‰è£…

```bash
go build -o claude_sync ./cmd
mv claude_sync /usr/local/bin/
```

## å¿«é€Ÿä¸Šæ‰‹

æŒ‰ä½ çš„ä½¿ç”¨åœºæ™¯é€‰æ‹©ä¸€æ¡ï¼š

**åœºæ™¯ 1ï¼šç¬¬ä¸€å°è®¾å¤‡ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰**

```bash
claude_sync init      # åˆ›å»ºæ–°çš„ Gist
claude_sync push      # æ¨é€æœ¬åœ°é…ç½®åˆ° Gist
```

**åœºæ™¯ 2ï¼šæ–°æœºå™¨åŒæ­¥ï¼ˆå·²æœ‰ Gistï¼ŒåŒä¸€ GitHub è´¦å·ï¼‰**

```bash
claude_sync init      # è‡ªåŠ¨æŸ¥æ‰¾å¹¶å…³è”å·²æœ‰ Gist
claude_sync pull      # æ‹‰å–è¿œç«¯é…ç½®ï¼ˆä¼šè¯¢é—®åˆå¹¶ç­–ç•¥ï¼‰
claude_sync push      # æ¨é€åˆå¹¶åçš„é…ç½®
```

> **è¯´æ˜**ï¼š
> - `init` ä¼šè‡ªåŠ¨æœç´¢ä½ è´¦å·ä¸‹çš„ claude_sync Gistï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®š `--gist-id`
> - å¦‚æœæ–°æœºå™¨æœ¬åœ°å·²æœ‰ Claude é…ç½®ï¼Œç›´æ¥ `push` ä¼šæç¤º `remote is ahead`ï¼Œéœ€è¦å…ˆ `pull`
> - **é¦–æ¬¡ pull æ—¶ä¼šè¯¢é—®åˆå¹¶ç­–ç•¥**ï¼š
>   - `[1] ä½¿ç”¨è¿œç«¯é…ç½®` - è¦†ç›–æœ¬åœ°
>   - `[2] ä¿ç•™æœ¬åœ°é…ç½®` - åªæ·»åŠ è¿œç«¯æ–°å¢é¡¹
>   - `[3] æ™ºèƒ½åˆå¹¶` - åˆå¹¶ä¸¤è¾¹ï¼Œå†²çªæ—¶é€ä¸ªè¯¢é—®
> - å¦‚é‡ MCP é…ç½®å†²çªï¼ˆå¦‚ `chrome-dev-tool` æœ¬åœ°å’Œè¿œç«¯ä¸åŒï¼‰ï¼Œä¼šæ˜¾ç¤ºå·®å¼‚å¹¶è®©ä½ é€‰æ‹©
> - åˆå¹¶å `push` å°†å®Œæ•´é…ç½®åŒæ­¥å› Gist

**åœºæ™¯ 3ï¼šæ–°æœºå™¨åŒæ­¥ï¼ˆä¸åŒ GitHub è´¦å·æˆ–æŒ‡å®š Gistï¼‰**

```bash
claude_sync init --gist-id <id>   # æ‰‹åŠ¨æŒ‡å®š Gist ID
claude_sync pull
claude_sync push
```

**åœºæ™¯ 4ï¼šæŠŠå…¨å±€ MCP é…ç½®åº”ç”¨åˆ°å½“å‰é¡¹ç›®**

```bash
claude_sync mcp-apply
```

**å¸¸è§å·¥ä½œæµ**ï¼š
- æœ¬åœ°æ”¹äº†é…ç½® â†’ `claude_sync push`
- è¿œç«¯æœ‰æ›´æ–° â†’ `claude_sync pull`
- æ–°é¡¹ç›®éœ€è¦ MCP â†’ `claude_sync mcp-apply`

## è¯¦ç»†ä½¿ç”¨

### åˆå§‹åŒ–

åˆ›å»ºæ–°çš„ Gist æˆ–ç»‘å®šå·²æœ‰ Gistï¼š

```bash
claude_sync init                    # è‡ªåŠ¨å¤ç”¨ claude_sync Gistï¼Œæ‰¾ä¸åˆ°åˆ™åˆ›å»º
claude_sync init --token ghp_xxxx   # ä½¿ç”¨ token
claude_sync init --gist-id <id>     # ç»‘å®šå·²æœ‰ Gist
```

è®¤è¯æ–¹å¼ï¼š
1. **æµè§ˆå™¨æˆæƒï¼ˆæ¨èï¼‰**ï¼šæ‰“å¼€æµè§ˆå™¨è¾“å…¥çŸ­ç æˆæƒï¼Œè‡ªåŠ¨è·å– token
2. **æ‰‹åŠ¨è¾“å…¥ token**ï¼šè¾“å…¥ GitHub Personal Access Token

Token æ¥æºä¼˜å…ˆçº§ï¼šå‘½ä»¤è¡Œå‚æ•° > `GITHUB_TOKEN` > å·²ä¿å­˜ token > äº¤äº’å¼è¾“å…¥

Device Flow æç¤ºï¼š
- æˆæƒé¡µé¢ä¸ä¼šæ˜¾ç¤ºçŸ­ç ï¼Œè¯·å°†ç»ˆç«¯ä¸­æ˜¾ç¤ºçš„ `UserCode` æ‰‹åŠ¨è¾“å…¥ã€‚
- ä¼šè‡ªåŠ¨æ‰“å¼€å¸¦ `user_code` çš„é“¾æ¥ï¼ˆæ”¯æŒç›´æ¥é¢„å¡«ï¼‰ã€‚
- å¯ç”¨ç¯å¢ƒå˜é‡æŒ‡å®š OAuth App Client IDï¼š`CLAUDE_SYNC_GITHUB_CLIENT_ID`ï¼ˆæˆ– `GITHUB_OAUTH_CLIENT_ID`ã€`GITHUB_CLIENT_ID`ï¼‰ã€‚

init ä¼šåœ¨ä½ çš„è´¦å·ä¸‹æŸ¥æ‰¾åŒ…å« `claude_sync.meta.json` ä¸” `repo` å­—æ®µä¸º `https://github.com/yxuechao007/claude_sync` çš„ Gistï¼›æ‰¾åˆ°å°±å¤ç”¨ï¼Œæ‰¾ä¸åˆ°æ‰åˆ›å»ºæ–°çš„ã€‚init ä¸ä¼šæ¨é€ä»»ä½•é…ç½®ã€‚

## å­å‘½ä»¤ä½¿ç”¨åœºæ™¯
- `init`ï¼šåˆæ¬¡ä½¿ç”¨æˆ–æ–°è®¾å¤‡æ¥å…¥ç°æœ‰ gistï¼›åˆ›å»º/ç»‘å®š gist
- `push`ï¼šæœ¬åœ°é…ç½®æ›´æ–°åä¸Šä¼ åˆ° gistï¼Œé€‚åˆâ€œæœ¬åœ°ä¸ºå‡†â€
- `pull`ï¼šä» gist æ‹‰å–é…ç½®åˆ°æœ¬åœ°ï¼Œé€‚åˆâ€œè¿œç«¯ä¸ºå‡†â€
- `status`ï¼šæŸ¥çœ‹æœ¬åœ°ä¸è¿œç«¯åŒæ­¥çŠ¶æ€
- `config --list`ï¼šæŸ¥çœ‹å½“å‰åŒæ­¥é…ç½®ä¸å¯ç”¨é¡¹
- `mcp-apply`ï¼šå°†å…¨å±€ MCP åŒæ­¥åˆ°å½“å‰é¡¹ç›®é…ç½®ï¼Œé»˜è®¤åˆå¹¶ï¼Œå¯ `--overwrite`
- `version`ï¼šæŸ¥çœ‹å·¥å…·ç‰ˆæœ¬

### æ¨é€/æ‹‰å–

```bash
# æ¨é€æœ¬åœ°é…ç½®åˆ° Gist
claude_sync push
claude_sync push --dry-run          # é¢„è§ˆå˜æ›´
claude_sync push --force            # å¼ºåˆ¶æ¨é€ï¼ˆè¦†ç›–å†²çªï¼‰

# æ‹‰å– Gist é…ç½®åˆ°æœ¬åœ°
claude_sync pull                    # æ˜¾ç¤º diff å¹¶ç¡®è®¤ï¼ˆé¦–æ¬¡åŒæ­¥ä¼šè¯¢é—®åˆå¹¶ç­–ç•¥ï¼‰
claude_sync pull -y                 # è‡ªåŠ¨ç¡®è®¤æ‰€æœ‰ä¿®æ”¹
claude_sync pull --force            # å¼ºåˆ¶æ‹‰å–ï¼ˆè¦†ç›–å†²çªï¼‰
claude_sync pull --use-remote       # ä½¿ç”¨è¿œç«¯é…ç½®ï¼ˆè¦†ç›–æœ¬åœ°ï¼‰
claude_sync pull --keep-local       # ä¿ç•™æœ¬åœ°é…ç½®ï¼ˆåªæ·»åŠ è¿œç«¯æ–°å¢é¡¹ï¼‰
claude_sync pull --keep-hooks       # ä¿ç•™æœ¬åœ° hooks
claude_sync pull --apply-mcp        # åŒæ—¶åŒæ­¥ MCP åˆ°å½“å‰é¡¹ç›®
claude_sync pull --apply-mcp --apply-mcp-overwrite
```

### MCP é¡¹ç›®åŒæ­¥

å°†å…¨å±€ MCP é…ç½®åŒæ­¥åˆ°å½“å‰é¡¹ç›®ï¼ˆè§£å†³æ¯æ¬¡æ–°å»ºé¡¹ç›®éƒ½è¦å¤åˆ¶ MCP é…ç½®çš„é—®é¢˜ï¼‰ï¼š

```bash
claude_sync mcp-apply               # åŒæ­¥ MCP åˆ°å½“å‰é¡¹ç›®
claude_sync mcp-apply -y            # è‡ªåŠ¨ç¡®è®¤
claude_sync mcp-apply --overwrite   # è¦†ç›–é¡¹ç›® MCPï¼ˆé»˜è®¤æ˜¯åˆå¹¶ï¼‰
```

é»˜è®¤è¡Œä¸ºä¼šä¿ç•™é¡¹ç›®å·²æœ‰çš„ `mcpServers` é…ç½®ï¼Œä»…è¡¥å……å…¨å±€ç¼ºå¤±é¡¹ï¼›å¦‚éœ€å®Œå…¨è¦†ç›–è¯·ä½¿ç”¨ `--overwrite`ã€‚

### çŠ¶æ€ä¸é…ç½®

```bash
claude_sync status                  # æŸ¥çœ‹åŒæ­¥çŠ¶æ€
claude_sync config --list           # æŸ¥çœ‹åŒæ­¥é¡¹é…ç½®
claude_sync version                 # æŸ¥çœ‹ç‰ˆæœ¬
claude_sync help                    # å¸®åŠ©ä¿¡æ¯
```

## åŒæ­¥å†…å®¹è¯¦è§£

### å­˜å‚¨åç«¯

- **GitHub Gist**ï¼ˆç§æœ‰ï¼‰

### é…ç½®ç›®å½•

```
~/.claude_sync/
â”œâ”€â”€ config.json   # åŒæ­¥é…ç½®
â”œâ”€â”€ state.json    # åŒæ­¥çŠ¶æ€ï¼ˆhash è®°å½•ï¼‰
â””â”€â”€ token         # GitHub Token
```

### åŒæ­¥é¡¹

| åç§° | æœ¬åœ°è·¯å¾„ | Gist æ–‡ä»¶ | ç±»å‹ | é»˜è®¤ | å­—æ®µè¿‡æ»¤ |
|------|---------|----------|------|------|---------|
| settings | `~/.claude/settings.json` | `settings.json` | æ–‡ä»¶ | å¯ç”¨ | æ’é™¤ `env` |
| claude-jsonï¼ˆå³ `~/.claude.json`ï¼‰ | `~/.claude.json` | `claude.json` | æ–‡ä»¶ | å¯ç”¨ | åªåŒæ­¥æŒ‡å®šå­—æ®µ* |
| output-styles | `~/.claude/output-styles/` | `output-styles.tar.gz` | ç›®å½• | å¯ç”¨ | æ—  |
| plans | `~/.claude/plans/` | `plans.tar.gz` | ç›®å½• | **ç¦ç”¨** | æ—  |
| todos | `~/.claude/todos/` | `todos.tar.gz` | ç›®å½• | **ç¦ç”¨** | æ—  |
| skills | `~/.claude/skills/` | `skills.tar.gz` | ç›®å½• | å¯ç”¨ | æ—  |
| plugins-list | `~/.claude/plugins/known_marketplaces.json` | `known_marketplaces.json` | æ–‡ä»¶ | å¯ç”¨ | æ—  |

*claude-jsonï¼ˆå³ `~/.claude.json`ï¼‰åªåŒæ­¥å­—æ®µï¼š`mcp`, `mcpServers`, `model`, `autoUpdates`, `showExpandedTodos`, `thinkingMigrationComplete`

> **æ³¨æ„**ï¼š`plans` å’Œ `todos` é»˜è®¤ç¦ç”¨ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¼šè¯ç›¸å…³çš„ä¸´æ—¶æ–‡ä»¶ï¼Œæ–‡ä»¶é‡å¤§ä¸”è·¨è®¾å¤‡åŒæ­¥æ„ä¹‰ä¸å¤§ã€‚å¦‚éœ€å¯ç”¨ï¼Œå¯ä¿®æ”¹ `~/.claude_sync/config.json`ã€‚

### ä¸åŒæ­¥çš„å†…å®¹

| ç›®å½•/æ–‡ä»¶ | åŸå›  |
|----------|------|
| `history.jsonl` | å¯¹è¯å†å²ï¼Œæ•æ„Ÿä¸”è®¾å¤‡ç‰¹å®š |
| `projects/` | é¡¹ç›®çº§é…ç½® |
| `debug/` | è°ƒè¯•æ—¥å¿— |
| `cache/` | ç¼“å­˜ |
| `statsig/` | ç»Ÿè®¡æ•°æ® |
| `shell-snapshots/` | Shell å¿«ç…§ |
| `file-history/` | æ–‡ä»¶å†å² |
| `session-env/` | ä¼šè¯ç¯å¢ƒ |

## åŒæ­¥æœºåˆ¶

### æ–‡ä»¶åŒæ­¥

1. è¯»å–æœ¬åœ°æ–‡ä»¶
2. åº”ç”¨å­—æ®µè¿‡æ»¤ï¼ˆIncludeFields / ExcludeFieldsï¼‰
3. **è¿‡æ»¤æœ¬åœ° hooks**ï¼ˆPush æ—¶è‡ªåŠ¨è¿‡æ»¤åŒ…å« `localhost`ã€`/Users/`ã€`/home/` ç­‰æœ¬åœ°è·¯å¾„çš„ hooksï¼‰
4. ä¸Šä¼ åˆ° Gist

### ç›®å½•åŒæ­¥

1. **æ‰“åŒ…**ï¼štar.gz å‹ç¼© â†’ Base64 ç¼–ç  â†’ å­˜ä¸º Gist æ–‡ä»¶
2. **è§£åŒ…**ï¼šBase64 è§£ç  â†’ è§£å‹ â†’ å†™å…¥æœ¬åœ°ç›®å½•
3. **è·³è¿‡éšè—æ–‡ä»¶**ï¼šç›®å½•å†…ä»¥ `.` å¼€å¤´çš„æ–‡ä»¶/ç›®å½•ä¼šè¢«è·³è¿‡ï¼ˆå¦‚ `.DS_Store`ã€`.git`ï¼‰

```
~/.claude/output-styles/
â”œâ”€â”€ coding-vibes.md        â† åŒæ­¥ âœ…
â”œâ”€â”€ structural-thinking.md â† åŒæ­¥ âœ…
â””â”€â”€ .DS_Store              â† è·³è¿‡ âŒ
```

### å˜æ›´æ£€æµ‹

- ä½¿ç”¨ SHA256 è®¡ç®—å†…å®¹ hash
- è®°å½• `LocalHash` å’Œ `RemoteHash` åˆ° `state.json`
- ä½¿ç”¨ `claude_sync.meta.json` ä¸­çš„ `version` åˆ¤å®šæ›´æ–°æ–¹å‘ï¼ˆæœ¬åœ°æ”¹åŠ¨ä¼šæå‡æœ¬åœ°ç‰ˆæœ¬ï¼Œè¿œç«¯æ”¹åŠ¨æå‡è¿œç«¯ç‰ˆæœ¬ï¼‰
- çŠ¶æ€åˆ¤æ–­ï¼š
  - `synced` - æœ¬åœ° = è¿œç¨‹
  - `local_ahead` - æœ¬åœ°æœ‰æ–°æ”¹åŠ¨
  - `remote_ahead` - è¿œç¨‹æœ‰æ–°æ”¹åŠ¨
  - `conflict` - åŒæ–¹éƒ½æœ‰æ”¹åŠ¨

### åˆå¹¶ç­–ç•¥

**æ–°æœºå™¨é¦–æ¬¡ Pull æ—¶ä¼šè¯¢é—®åˆå¹¶ç­–ç•¥**ï¼š

```
ğŸ”„ æ£€æµ‹åˆ°è¿™æ˜¯æ–°æœºå™¨é¦–æ¬¡åŒæ­¥ï¼Œä¸”æœ¬åœ°å·²æœ‰é…ç½®

å¦‚ä½•å¤„ç†æœ¬åœ°ä¸è¿œç«¯é…ç½®çš„å·®å¼‚?
  [1] ä½¿ç”¨è¿œç«¯é…ç½® (è¦†ç›–æœ¬åœ°)
  [2] ä¿ç•™æœ¬åœ°é…ç½® (åªæ·»åŠ è¿œç«¯æ–°å¢é¡¹)
  [3] æ™ºèƒ½åˆå¹¶ (åˆå¹¶ä¸¤è¾¹ï¼ŒMCP å†²çªæ—¶é€ä¸ªè¯¢é—®)
  [4] å–æ¶ˆ
```

**ç­–ç•¥å¯¹ä¸åŒæ–‡ä»¶ç±»å‹çš„å½±å“**ï¼š

| ç­–ç•¥ | MCP é…ç½® (claude.json) | å¸¦è¿‡æ»¤çš„ JSON (settings.json) | æ™®é€šæ–‡ä»¶ (marketplaces.json) |
|------|------------------------|------------------------------|------------------------------|
| ä½¿ç”¨è¿œç«¯ | è¦†ç›–æœ¬åœ° | è¿œç«¯å­—æ®µè¦†ç›–æœ¬åœ° | è¦†ç›–æœ¬åœ° |
| ä¿ç•™æœ¬åœ° | åªæ·»åŠ è¿œç«¯æ–°å¢ MCP | åªæ·»åŠ è¿œç«¯æ–°å¢å­—æ®µ | ä¿ç•™æœ¬åœ°ä¸å˜ |
| æ™ºèƒ½åˆå¹¶ | åˆå¹¶ï¼Œå†²çªæ—¶è¯¢é—® | è¿œç«¯å­—æ®µè¦†ç›–æœ¬åœ° | è¦†ç›–æœ¬åœ° |

> **æ³¨æ„**ï¼šé€æ¡å†²çªè¯¢é—®**ä»…å¯¹ MCP é…ç½®**ç”Ÿæ•ˆï¼ˆ`mcpServers` å’Œ `projects[].mcpServers`ï¼‰ã€‚å…¶ä»–æ–‡ä»¶ä¸ä¼šé€å­—æ®µè¯¢é—®ã€‚

**MCP å†²çªè§£å†³**ï¼ˆæ™ºèƒ½åˆå¹¶æ¨¡å¼ï¼‰ï¼š

å½“åŒä¸€ä¸ª MCP serverï¼ˆå¦‚ `chrome-dev-tool`ï¼‰æœ¬åœ°å’Œè¿œç«¯é…ç½®ä¸åŒæ—¶ï¼Œä¼šæ˜¾ç¤ºå·®å¼‚å¹¶è¯¢é—®ï¼š

```
âš ï¸  é…ç½®å†²çª: mcpServers.chrome-dev-tool
â”Œâ”€ æœ¬åœ°é…ç½®:
â”‚  { "command": "/usr/local/bin/chrome-dev-tool", ... }
â”œâ”€ è¿œç«¯é…ç½®:
â”‚  { "command": "/opt/chrome-dev-tool", ... }
â””â”€

é€‰æ‹©:
  [1] ä½¿ç”¨è¿œç«¯é…ç½®
  [2] ä¿ç•™æœ¬åœ°é…ç½®
  [3] å…¨éƒ¨ä½¿ç”¨è¿œç«¯ (åç»­å†²çªä¸å†è¯¢é—®)
  [4] å…¨éƒ¨ä¿ç•™æœ¬åœ° (åç»­å†²çªä¸å†è¯¢é—®)
```

**åˆå¹¶ç¤ºä¾‹**ï¼š

```
æœ¬åœ° mcpServers: { "serverA": {...}, "serverB": {...} }
è¿œç«¯ mcpServers: { "serverA": {...ä¸åŒ}, "serverC": {...} }
æ™ºèƒ½åˆå¹¶å: { "serverA": {...ç”¨æˆ·é€‰æ‹©}, "serverB": {...}, "serverC": {...} }
```

- **å»é‡æœºåˆ¶**ï¼šç›¸åŒ key åªä¿ç•™ä¸€ä»½ï¼Œä¸ä¼šæ— é™å¢é•¿
- **projects ä¸­çš„ mcpServers**ï¼šåŒæ ·æŒ‰ key åˆå¹¶ï¼Œå†²çªæ—¶è¯¢é—®
- **ä¿ç•™æœ¬åœ°ç­–ç•¥**ï¼šå·²æœ‰é¡¹ç›®çš„ mcpServers ä¹Ÿä¼šæ·»åŠ è¿œç«¯æ–°å¢çš„ keyï¼ˆä¸ä¼šè¦†ç›–å·²æœ‰ keyï¼‰

**Push æ—¶çš„è¡Œä¸º**ï¼š

- é¡¹ç›®çº§ MCP é…ç½®ä¼šåˆå¹¶åˆ°å…¨å±€ mcpServers åå†æ¨é€
- ç¡®ä¿åœ¨æŸä¸ªé¡¹ç›®ä¸­é…ç½®çš„ MCP æœåŠ¡å™¨èƒ½åŒæ­¥åˆ°å…¶ä»–è®¾å¤‡

**æ–°æœºå™¨é¦–æ¬¡åŒæ­¥**ï¼š

- `init` åç›´æ¥ `push` ä¼šæç¤º `remote is ahead`
- éœ€è¦å…ˆ `pull` åˆå¹¶é…ç½®ï¼Œå† `push` æ¨é€

**å‘½ä»¤è¡Œå‚æ•°**ï¼š

- `--use-remote`ï¼šç›´æ¥ä½¿ç”¨è¿œç«¯é…ç½®ï¼Œè·³è¿‡è¯¢é—®
- `--keep-local`ï¼šä¿ç•™æœ¬åœ°é…ç½®ï¼Œåªæ·»åŠ è¿œç«¯æ–°å¢é¡¹ï¼ˆå¯¹æ‰€æœ‰æ–‡ä»¶ç”Ÿæ•ˆï¼‰
- `-y`ï¼šè‡ªåŠ¨ç¡®è®¤ï¼ˆMCP å†²çªæ—¶é»˜è®¤ä¿ç•™æœ¬åœ°ï¼‰

### Diff ç¡®è®¤

Pull æ—¶ä¼šæ˜¾ç¤ºæ–‡ä»¶å·®å¼‚å¹¶ç­‰å¾…ç¡®è®¤ï¼š

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ–‡ä»¶: ~/.claude/settings.json
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
- "model": "sonnet"
+ "model": "opus"
  "alwaysThinkingEnabled": true
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
åº”ç”¨æ­¤ä¿®æ”¹? [y/N/a/q/p] (y=æ˜¯, N=å¦, a=å…¨éƒ¨, q=é€€å‡º, p=é¢„è§ˆ):
```

ä½¿ç”¨ `-y` æˆ– `--yes` å‚æ•°å¯è·³è¿‡ç¡®è®¤ã€‚

## Hooks ç­–ç•¥

### Push æ—¶

è‡ªåŠ¨è¿‡æ»¤åŒ…å«ä»¥ä¸‹æœ¬åœ°ç‰¹å®šå†…å®¹çš„ hooksï¼š
- `localhost:ç«¯å£`ã€`127.0.0.1:ç«¯å£`
- `/Users/xxx/`ï¼ˆmacOSï¼‰
- `/home/xxx/`ï¼ˆLinuxï¼‰
- `C:\Users\xxx\`ï¼ˆWindowsï¼‰

### Pull æ—¶

å¦‚æœæ£€æµ‹åˆ°è¿œç«¯ hooks å«è®¾å¤‡ç‰¹å®šå†…å®¹ï¼Œä¼šæç¤ºé€‰æ‹©ï¼š
1. **è¦†ç›–æœ¬åœ° hooks** - ä½¿ç”¨è¿œç¨‹é…ç½®
2. **ä¿ç•™æœ¬åœ° hooks** - åªåŒæ­¥å…¶ä»–è®¾ç½®
3. **æ™ºèƒ½åˆå¹¶** - åªè¦†ç›–ä¸å«æœ¬åœ°å†…å®¹çš„ hooks
4. **å–æ¶ˆ**

ä¹Ÿå¯ç”¨ `--keep-hooks` ç›´æ¥ä¿ç•™æœ¬åœ° hooksã€‚

## é…ç½®æ–‡ä»¶å­—æ®µåˆ†æ

### ~/.claude/settings.json

| å­—æ®µ | ä½œç”¨ | æ˜¯å¦åŒæ­¥ | è¯´æ˜ |
|------|------|---------|------|
| `alwaysThinkingEnabled` | æ˜¯å¦æ€»æ˜¯å¯ç”¨æ€è€ƒæ¨¡å¼ | âœ… | ç”¨æˆ·åå¥½ |
| `model` | é»˜è®¤æ¨¡å‹ï¼ˆå¦‚ opusï¼‰ | âœ… | ç”¨æˆ·åå¥½ |
| `env` | è®¾å¤‡ç‰¹å®šç¯å¢ƒå˜é‡ | âŒ | æ¯å°æœºå™¨è·¯å¾„ä¸åŒ |
| `hooks` | é’©å­è„šæœ¬é…ç½® | âš ï¸ | è‡ªåŠ¨è¿‡æ»¤æœ¬åœ°è·¯å¾„ |

### ~/.claude.json

| å­—æ®µ | ä½œç”¨ | æ˜¯å¦åŒæ­¥ | è¯´æ˜ |
|------|------|---------|------|
| `autoUpdates` | è‡ªåŠ¨æ›´æ–°å¼€å…³ | âœ… | ç”¨æˆ·åå¥½ |
| `model` | é»˜è®¤æ¨¡å‹ | âœ… | ç”¨æˆ·åå¥½ |
| `mcp` / `mcpServers` | MCP æœåŠ¡å™¨é…ç½® | âœ… | ç”¨æˆ·åå¥½ |
| `tipsHistory` | å·²æ˜¾ç¤ºçš„æç¤º | âœ… | é¿å…é‡å¤æ˜¾ç¤º |
| `showExpandedTodos` | Todo å±•å¼€çŠ¶æ€ | âœ… | UI åå¥½ |
| `numStartups` | å¯åŠ¨æ¬¡æ•°ç»Ÿè®¡ | âŒ | è®¾å¤‡ç‰¹å®š |
| `installMethod` | å®‰è£…æ–¹å¼ | âŒ | è®¾å¤‡ç‰¹å®š |
| `customApiKeyResponses` | API Key å®¡æ‰¹è®°å½• | âŒ | å®‰å…¨ç›¸å…³ |
| `cached*` | å„ç§ç¼“å­˜ | âŒ | ä¸´æ—¶æ•°æ® |

## è‡ªåŠ¨åŒæ­¥ MCP é…ç½®ï¼ˆæ¨èï¼‰

é€šè¿‡é…ç½® Claude Code çš„ `SessionStart` hookï¼Œå¯ä»¥åœ¨æ¯æ¬¡å¯åŠ¨æ–°ä¼šè¯æ—¶è‡ªåŠ¨å°†å…¨å±€ MCP é…ç½®åŒæ­¥åˆ°å½“å‰é¡¹ç›®ã€‚

### é…ç½®æ–¹æ³•

ç¼–è¾‘ `~/.claude/settings.json`ï¼Œæ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

```json
{
  "hooks": {
    "SessionStart": [
      {
        "matcher": "startup",
        "hooks": [
          {
            "type": "command",
            "command": "claude_sync mcp-apply -y 2>/dev/null || true"
          }
        ]
      }
    ]
  }
}
```

### é…ç½®è¯´æ˜

- `SessionStart`ï¼šClaude Code ä¼šè¯å¯åŠ¨æ—¶è§¦å‘
- `matcher: "startup"`ï¼šä»…åœ¨æ–°å¯åŠ¨æ—¶è§¦å‘ï¼ˆä¸åŒ…æ‹¬ resume/continueï¼‰
- `claude_sync mcp-apply -y`ï¼šè‡ªåŠ¨ç¡®è®¤åŒæ­¥ MCP é…ç½®
- `claude_sync mcp-apply --overwrite`ï¼šè¦†ç›–é¡¹ç›® MCPï¼ˆä¸åˆå¹¶ï¼‰
- `2>/dev/null || true`ï¼šé™é»˜æ‰§è¡Œï¼Œå³ä½¿å¤±è´¥ä¹Ÿä¸å½±å“ Claude Code å¯åŠ¨

### æ•ˆæœ

é…ç½®åï¼Œæ¯æ¬¡åœ¨æ–°é¡¹ç›®ç›®å½•ä¸­è¿è¡Œ Claude Code æ—¶ï¼š
1. è‡ªåŠ¨æ£€æµ‹å…¨å±€ MCP é…ç½®
2. å°† MCP é…ç½®åŒæ­¥åˆ°å½“å‰é¡¹ç›®çš„ `~/.claude.json` ä¸­
3. æ— éœ€æ‰‹åŠ¨å¤åˆ¶é…ç½®

### å¯é€‰çš„åŒ¹é…å™¨

- `startup`ï¼šä»å¯åŠ¨è§¦å‘
- `resume`ï¼šä» `--resume`ã€`--continue` æˆ– `/resume` è§¦å‘
- `clear`ï¼šä» `/clear` è§¦å‘
- `compact`ï¼šä»ä¸Šä¸‹æ–‡å‹ç¼©è§¦å‘

å¦‚éœ€åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½åŒæ­¥ï¼Œå¯ä»¥çœç•¥ `matcher` å­—æ®µã€‚

## å‘å¸ƒæ–°ç‰ˆæœ¬

åˆ›å»º tag åä¼šè‡ªåŠ¨æ„å»ºå¹¶å‘å¸ƒåˆ° GitHub Releasesï¼ˆRelease äº§ç‰©æ¥è‡ª `bin/` ç›®å½•ï¼‰ï¼š

```bash
git tag v1.0.0
git push origin v1.0.0
```

æ”¯æŒçš„å¹³å°ï¼š
- Linux (amd64, arm64)
- macOS (amd64, arm64)
- Windows (amd64)

## æ³¨æ„äº‹é¡¹

- æœ¬åœ°ç¼ºå¤±æ–‡ä»¶æˆ–ç©ºæ–‡ä»¶ä¸ä¼šåˆ é™¤è¿œç«¯æ–‡ä»¶
- ç›®å½•åŒæ­¥ä¸ä¼šåŒ…å«éšè—æ–‡ä»¶/ç›®å½•
- MCP ç‰ˆæœ¬ä¿¡æ¯ä¿å­˜åœ¨ gist çš„ `claude_sync.meta.json` ä¸­
- æ–°åˆå§‹åŒ–æ—¶ `plans` å’Œ `todos` é»˜è®¤ç¦ç”¨ï¼Œç°æœ‰ç”¨æˆ·éœ€æ‰‹åŠ¨ä¿®æ”¹é…ç½®

## License

MIT
